<div class="new-clusters-wrapper">
  <h1>Create Kubernetes Cluster</h1>

  <mat-horizontal-stepper [linear]="true" #stepper>

    <mat-step label="Cloud Account">
      <mat-form-field>
        <mat-select placeholder="Choose a cloud account" [(value)]="selectedCloudAccount" (selectionChange)="selectCloudAccount($event.value)">
          <mat-option *ngFor="let account of availableCloudAccounts" [value]="account">{{ account.name }}</mat-option>
        </mat-select>
      </mat-form-field>
      <div>
        <button mat-raised-button class="secondary">LOAD PROFILE</button>
        <button mat-raised-button matStepperNext>Next</button>
      </div>
    </mat-step>

    <mat-step label="Cluster Configuration" [stepControl]="clusterConfig">
      <form [formGroup]="clusterConfig" class="cluster-config-form">
        <div class="input-group">
          <mat-form-field>
            <input matInput type="text" placeholder="Specify Name" formControlName="name">
          </mat-form-field>

          <mat-form-field>
            <mat-select placeholder="K8s Version" formControlName="k8sVersion">
              <mat-option *ngFor="let k of clusterOptions.k8sVersions" [value]="k">{{ k }}</mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field>
            <mat-select placeholder="Flannel Version" formControlName="flannelVersion">
              <mat-option *ngFor="let f of clusterOptions.flannelVersions" [value]="f">{{ f }}</mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field>
            <mat-select placeholder="Helm Version" formControlName="helmVersion">
              <mat-option *ngFor="let h of clusterOptions.helmVersions" [value]="h">{{ h }}</mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field>
            <mat-select placeholder="Docker Version" formControlName="dockerVersion">
              <mat-option *ngFor="let d of clusterOptions.dockerVersions" [value]="d">{{ d }}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>

        <div class="input-group">
          <mat-form-field>
            <mat-select placeholder="Ubuntu Version" formControlName="ubuntuVersion">
              <mat-option *ngFor="let u of clusterOptions.ubuntuVersions" [value]="u">{{ u }}</mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field>
            <mat-select placeholder="Network Type" formControlName="networkType">
              <mat-option *ngFor="let n of clusterOptions.networkTypes" [value]="n">{{ n }}</mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field>
            <input matInput placeholder="cidr" type="text" formControlName="cidr">
          </mat-form-field>

          <mat-form-field>
            <mat-select placeholder="Operating System" formControlName="operatingSystem">
              <mat-option *ngFor="let os of clusterOptions.operatingSystems" [value]="os">{{ os }}</mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field>
            <mat-select placeholder="Arch" formControlName="arch">
              <mat-option *ngFor="let a of clusterOptions.archs" [value]="a">{{ a }}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </form>

      <div>
        <button mat-raised-button matStepperPrevious>Back</button>
        <button mat-raised-button matStepperNext>Next</button>
      </div>
    </mat-step>

    <mat-step label="Provider Configuration" [stepControl]="providerConfig">
      <!-- digital ocean -->
      <ng-container *ngIf="selectedCloudAccount?.provider == 'digitalocean'">
        <form [formGroup]="providerConfig">
          <mat-form-field>
            <mat-select placeholder="Select a Region" formControlName="region" (selectionChange)="selectRegion($event.value)">
              <mat-option *ngFor="let r of availableRegions?.regions" [value]="r">{{ r.name }}</mat-option>
            </mat-select>
          </mat-form-field>
        </form>
      </ng-container>

      <div>
        <button mat-raised-button matStepperPrevious>Back</button>
        <button mat-raised-button matStepperNext>Next</button>
      </div>
    </mat-step>

    <mat-step label="Machine Configuration" [stepControl]="machineConfig">
      <div class="machine-config-step">
        <!-- digital ocean machines -->
        <ng-container *ngIf="selectedCloudAccount?.provider == 'digitalocean'" >
          <div class="machine" *ngFor="let m of machines; let idx = index">
            <mat-form-field class="type">
              <mat-select placeholder="Machine Type (size)" id="m.machineType" [(value)]="m.machineType">
                <mat-option *ngFor="let type of availableMachineTypes" [value]="type">{{ type }}</mat-option>
              </mat-select>
            </mat-form-field>

            <mat-form-field class="role">
              <mat-select placeholder="Role" [(value)]="m.role" >
                <mat-option value="Master">Master</mat-option>
                <mat-option value="Node">Node</mat-option>
              </mat-select>
            </mat-form-field>

            <mat-form-field class="quantity">
              <input matInput type="number" min="1" placeholder="Q-ty" [(ngModel)]="m.qty">
            </mat-form-field>

            <div class="delete" (click)="deleteMachine(idx)"></div>
          </div>

          <div class="add-machines" (click)="addBlankMachine()">
            <div class="plus"></div>
            <span class="add-label">Add more machines</span>
          </div>
        </ng-container>
      </div>

      <div>
        <button mat-raised-button matStepperPrevious>Back</button>
        <button mat-raised-button matStepperNext>Next</button>
      </div>
    </mat-step>

    <mat-step label="Review">
      <div class="review-wrapper">
        <div class="cloud-account">
          <h3>CLOUD ACCOUNT</h3>
          <p>{{ selectedCloudAccount?.name }}</p>
        </div>

        <div class="cluster">
          <h3>CLUSTER DETAILS</h3>
        </div>

        <div class="provider">
          <h3>PROVIDER CONFIGURATION</h3>
        </div>

        <div class="machines">
          <h3>MACHINES</h3>
        </div>

        <div class="action-buttons-wrapper">
          <button mat-raised-button class="secondary">SAVE PROFILE</button>
          <button mat-raised-button color="primary" (click)="createCluster(newDigitalOceanCluster)">CREATE</button>
        </div>
      </div>
    </mat-step>

  </mat-horizontal-stepper>

  <!-- <div class="inputs-wrapper" [ngClass]="{ large: selectedCloudAccount }">

    <div class="input-group">
      <mat-form-field>
        <mat-select placeholder="Select a Cloud Account" [(value)]="selectedCloudAccount" (selectionChange)="selectCloudAccount($event.value)">
          <mat-option *ngFor="let c of availableCloudAccounts" [value]="c">{{ c.name }}</mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field *ngIf="selectedCloudAccount">
        <input matInput type="text" [(ngModel)]="clusterName" placeholder="Specify Name">
      </mat-form-field>

      <mat-form-field *ngIf="selectedCloudAccount">
        <mat-select placeholder="Select a Region" [(value)]="selectedRegion" (selectionChange)="selectRegion($event.value)">
          <mat-option *ngFor="let r of availableRegions?.regions" [value]="r">{{ r.name }}</mat-option>
        </mat-select>
      </mat-form-field>

      <div class="machine-list" *ngIf="selectedCloudAccount" [ngClass]="{ disable: !selectedRegion }">
        <div class="machine" *ngFor="let m of machines; let idx = index">
          <mat-form-field class="type">
            <mat-select placeholder="Machine Type (size)" id="m.machineType" [(value)]="m.machineType">
              <mat-option *ngFor="let type of availableMachineTypes" [value]="type">{{ type }}</mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field class="role">
            <mat-select placeholder="Role" [(value)]="m.role" >
              <mat-option value="Master">Master</mat-option>
              <mat-option value="Node">Node</mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field class="quantity">
            <input matInput type="number" min="1" placeholder="Q-ty" [(ngModel)]="m.qty">
          </mat-form-field>

          <div class="delete" (click)="deleteMachine(idx)"></div>
        </div>

        <div class="add-machines" *ngIf="selectedCloudAccount" (click)="addBlankMachine()">
          <div class="plus"></div>
          <span class="add-label">Add more machines</span>
        </div>
      </div>
    </div>

    <div class="input-group" *ngIf="selectedCloudAccount">
      <div class="profile-row">
        <mat-form-field>
          <mat-select placeholder="Arch" [(value)]="newDigitalOceanCluster.profile.arch">
            <mat-option *ngFor="let a of profileOptions.archs" [value]="a">{{ a }}</mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field>
          <mat-select placeholder="Flannel Version" [(value)]="newDigitalOceanCluster.profile.flannelVersion">
            <mat-option *ngFor="let f of profileOptions.flannelVersions" [value]="f">{{ f }}</mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <div class="profile-row">
        <mat-form-field>
          <mat-select placeholder="Operating System" [(value)]="newDigitalOceanCluster.profile.operatingSystem">
            <mat-option *ngFor="let os of profileOptions.operatingSystems" [value]="os">{{ os }}</mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field>
          <mat-select placeholder="Network Type" [(value)]="newDigitalOceanCluster.profile.networkType">
            <mat-option *ngFor="let n of profileOptions.networkTypes" [value]="n">{{ n }}</mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <div class="profile-row">
        <mat-form-field>
          <mat-select placeholder="Ubuntu Version" [(value)]="newDigitalOceanCluster.profile.ubuntuVersion">
            <mat-option *ngFor="let u of profileOptions.ubuntuVersions" [value]="u">{{ u }}</mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field>
          <input matInput placeholder="cidr" type="text" name="" [(value)]="newDigitalOceanCluster.profile.cidr">
        </mat-form-field>
      </div>

      <div class="profile-row">
        <mat-form-field>
          <mat-select placeholder="Docker Version" [(value)]="newDigitalOceanCluster.profile.dockerVersion">
            <mat-option *ngFor="let d of profileOptions.dockerVersions" [value]="d">{{ d }}</mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field>
          <mat-select placeholder="Helm Version" [(value)]="newDigitalOceanCluster.profile.helmVersion">
            <mat-option *ngFor="let h of profileOptions.helmVersions" [value]="h">{{ h }}</mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <div class="profile-row">
        <mat-form-field>
          <mat-select placeholder="K8S Version" [(value)]="newDigitalOceanCluster.profile.K8SVersion">
            <mat-option *ngFor="let k of profileOptions.K8SVersions" [value]="k">{{ k }}</mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field>
          <mat-select placeholder="RBAC Enabled" [(value)]="newDigitalOceanCluster.profile.rbacEnabled">
            <mat-option *ngFor="let b of profileOptions.rbacEnabled" [value]="b">{{ b }}</mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <div class="action-buttons-wrapper">
        <button mat-raised-button class="secondary">LOAD CONF.</button>
        <button mat-raised-button class="secondary">SAVE CONF.</button>
        <button mat-raised-button color="primary" (click)="createCluster(newDigitalOceanCluster)">CREATE</button>
      </div>
  </div> -->

</div>
